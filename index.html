<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Currency Converter</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .converter-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .header-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            margin: 0 auto 20px;
        }
        
        .form-control, .form-select {
            border-radius: 15px;
            border: 2px solid #e9ecef;
            padding: 12px 16px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        
        .btn-convert {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 15px;
            padding: 12px 30px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn-convert:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .result-container {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            border: 2px solid #dee2e6;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .result-text {
            font-size: 1.25rem;
            font-weight: 600;
            color: #495057;
        }
        
        .loading-spinner {
            display: none;
        }
        
        .swap-btn {
            background: #fff;
            border: 2px solid #667eea;
            color: #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .swap-btn:hover {
            background: #667eea;
            color: white;
            transform: rotate(180deg);
        }
        
        .currency-flag {
            width: 20px;
            height: 15px;
            margin-right: 8px;
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-6 col-lg-5">
                <div class="converter-container p-4">
                    <!-- Header -->
                    <div class="text-center mb-4">
                        <div class="header-icon">
                            ðŸ’±
                        </div>
                        <h2 class="h3 mb-0 text-dark">Currency Converter</h2>
                        <p class="text-muted small mb-0">Real-time exchange rates</p>
                    </div>

                    <!-- Currency Converter Form -->
                    <form id="currencyForm">
                        <!-- Source Currency -->
                        <div class="mb-3">
                            <label for="sourceCurrency" class="form-label fw-semibold">From</label>
                            <select class="form-select" id="sourceCurrency" required>
                                <option value="">Select source currency</option>
                                <option value="USD" selected>ðŸ‡ºðŸ‡¸ USD - US Dollar</option>
                                <option value="EUR">ðŸ‡ªðŸ‡º EUR - Euro</option>
                                <option value="GBP">ðŸ‡¬ðŸ‡§ GBP - British Pound</option>
                                <option value="JPY">ðŸ‡¯ðŸ‡µ JPY - Japanese Yen</option>
                                <option value="AUD">ðŸ‡¦ðŸ‡º AUD - Australian Dollar</option>
                                <option value="CAD">ðŸ‡¨ðŸ‡¦ CAD - Canadian Dollar</option>
                                <option value="CHF">ðŸ‡¨ðŸ‡­ CHF - Swiss Franc</option>
                                <option value="CNY">ðŸ‡¨ðŸ‡³ CNY - Chinese Yuan</option>
                                <option value="INR">ðŸ‡®ðŸ‡³ INR - Indian Rupee</option>
                                <option value="KRW">ðŸ‡°ðŸ‡· KRW - South Korean Won</option>
                                <option value="SGD">ðŸ‡¸ðŸ‡¬ SGD - Singapore Dollar</option>
                                <option value="NZD">ðŸ‡³ðŸ‡¿ NZD - New Zealand Dollar</option>
                                <option value="MXN">ðŸ‡²ðŸ‡½ MXN - Mexican Peso</option>
                                <option value="BRL">ðŸ‡§ðŸ‡· BRL - Brazilian Real</option>
                                <option value="RUB">ðŸ‡·ðŸ‡º RUB - Russian Ruble</option>
                                <option value="ZAR">ðŸ‡¿ðŸ‡¦ ZAR - South African Rand</option>
                            </select>
                        </div>

                        <!-- Swap Button -->
                        <div class="text-center my-3">
                            <button type="button" class="swap-btn" id="swapBtn" title="Swap currencies">
                                â‡…
                            </button>
                        </div>

                        <!-- Target Currency -->
                        <div class="mb-3">
                            <label for="targetCurrency" class="form-label fw-semibold">To</label>
                            <select class="form-select" id="targetCurrency" required>
                                <option value="">Select target currency</option>
                                <option value="USD">ðŸ‡ºðŸ‡¸ USD - US Dollar</option>
                                <option value="EUR" selected>ðŸ‡ªðŸ‡º EUR - Euro</option>
                                <option value="GBP">ðŸ‡¬ðŸ‡§ GBP - British Pound</option>
                                <option value="JPY">ðŸ‡¯ðŸ‡µ JPY - Japanese Yen</option>
                                <option value="AUD">ðŸ‡¦ðŸ‡º AUD - Australian Dollar</option>
                                <option value="CAD">ðŸ‡¨ðŸ‡¦ CAD - Canadian Dollar</option>
                                <option value="CHF">ðŸ‡¨ðŸ‡­ CHF - Swiss Franc</option>
                                <option value="CNY">ðŸ‡¨ðŸ‡³ CNY - Chinese Yuan</option>
                                <option value="INR">ðŸ‡®ðŸ‡³ INR - Indian Rupee</option>
                                <option value="KRW">ðŸ‡°ðŸ‡· KRW - South Korean Won</option>
                                <option value="SGD">ðŸ‡¸ðŸ‡¬ SGD - Singapore Dollar</option>
                                <option value="NZD">ðŸ‡³ðŸ‡¿ NZD - New Zealand Dollar</option>
                                <option value="MXN">ðŸ‡²ðŸ‡½ MXN - Mexican Peso</option>
                                <option value="BRL">ðŸ‡§ðŸ‡· BRL - Brazilian Real</option>
                                <option value="RUB">ðŸ‡·ðŸ‡º RUB - Russian Ruble</option>
                                <option value="ZAR">ðŸ‡¿ðŸ‡¦ ZAR - South African Rand</option>
                            </select>
                        </div>

                        <!-- Amount Input -->
                        <div class="mb-4">
                            <label for="amount" class="form-label fw-semibold">Amount</label>
                            <input type="number" class="form-control" id="amount" placeholder="Enter amount" 
                                   min="0" step="0.01" value="100" required>
                        </div>

                        <!-- Convert Button -->
                        <div class="d-grid mb-4">
                            <button type="submit" class="btn btn-convert btn-primary">
                                <span class="button-text">Convert</span>
                                <div class="loading-spinner spinner-border spinner-border-sm ms-2" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </button>
                        </div>
                    </form>

                    <!-- Result Display -->
                    <div class="result-container p-3">
                        <div id="result" class="result-text">
                            Enter amount and select currencies to convert
                        </div>
                    </div>

                    <!-- Exchange Rate Info -->
                    <div id="rateInfo" class="text-center mt-3 text-muted small" style="display: none;">
                        <span id="rateText"></span>
                    </div>

                    <!-- Last Updated -->
                    <div id="lastUpdated" class="text-center mt-2 text-muted" style="font-size: 0.75rem; display: none;">
                        <span id="updateTime"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Currency converter application
        class CurrencyConverter {
            constructor() {
                // API configuration - using exchangerate-api.com (free tier)
                this.apiKey = 'YOUR_API_KEY'; // You can sign up for free at exchangerate-api.com
                this.apiUrl = 'https://api.exchangerate-api.com/v4/latest/'; // Free endpoint without API key
                this.fallbackApiUrl = 'https://api.fxratesapi.com/latest?base='; // Fallback API
                
                // DOM elements
                this.form = document.getElementById('currencyForm');
                this.sourceCurrency = document.getElementById('sourceCurrency');
                this.targetCurrency = document.getElementById('targetCurrency');
                this.amountInput = document.getElementById('amount');
                this.resultDiv = document.getElementById('result');
                this.swapBtn = document.getElementById('swapBtn');
                this.loadingSpinner = document.querySelector('.loading-spinner');
                this.buttonText = document.querySelector('.button-text');
                this.rateInfo = document.getElementById('rateInfo');
                this.rateText = document.getElementById('rateText');
                this.lastUpdated = document.getElementById('lastUpdated');
                this.updateTime = document.getElementById('updateTime');
                
                // Cache for exchange rates
                this.ratesCache = {};
                this.cacheExpiry = 5 * 60 * 1000; // 5 minutes
                
                this.initializeEventListeners();
            }
            
            // Initialize event listeners
            initializeEventListeners() {
                this.form.addEventListener('submit', (e) => this.handleSubmit(e));
                this.swapBtn.addEventListener('click', () => this.swapCurrencies());
                
                // Auto-convert when inputs change (with debounce)
                let debounceTimer;
                const autoConvert = () => {
                    clearTimeout(debounceTimer);
                    debounceTimer = setTimeout(() => {
                        if (this.sourceCurrency.value && this.targetCurrency.value && this.amountInput.value) {
                            this.convertCurrency();
                        }
                    }, 500);
                };
                
                this.sourceCurrency.addEventListener('change', autoConvert);
                this.targetCurrency.addEventListener('change', autoConvert);
                this.amountInput.addEventListener('input', autoConvert);
            }
            
            // Handle form submission
            async handleSubmit(e) {
                e.preventDefault();
                await this.convertCurrency();
            }
            
            // Main currency conversion function
            async convertCurrency() {
                const source = this.sourceCurrency.value;
                const target = this.targetCurrency.value;
                const amount = parseFloat(this.amountInput.value);
                
                // Validation
                if (!source || !target || !amount || amount <= 0) {
                    this.showError('Please fill in all fields with valid values');
                    return;
                }
                
                if (source === target) {
                    this.showResult(amount, source, target, 1);
                    return;
                }
                
                this.showLoading(true);
                
                try {
                    const rate = await this.getExchangeRate(source, target);
                    const convertedAmount = amount * rate;
                    this.showResult(amount, source, target, rate, convertedAmount);
                } catch (error) {
                    console.error('Conversion error:', error);
                    this.showError('Failed to fetch exchange rates. Please try again.');
                } finally {
                    this.showLoading(false);
                }
            }
            
            // Fetch exchange rate from API
            async getExchangeRate(fromCurrency, toCurrency) {
                const cacheKey = `${fromCurrency}_${toCurrency}`;
                const now = Date.now();
                
                // Check cache first
                if (this.ratesCache[cacheKey] && 
                    (now - this.ratesCache[cacheKey].timestamp) < this.cacheExpiry) {
                    return this.ratesCache[cacheKey].rate;
                }
                
                try {
                    // Try primary API first
                    let response = await fetch(`${this.apiUrl}${fromCurrency}`);
                    
                    if (!response.ok) {
                        // Try fallback API
                        response = await fetch(`${this.fallbackApiUrl}${fromCurrency}`);
                    }
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    // Handle different API response formats
                    let rates;
                    if (data.rates) {
                        rates = data.rates;
                    } else if (data.conversion_rates) {
                        rates = data.conversion_rates;
                    } else {
                        throw new Error('Invalid API response format');
                    }
                    
                    if (!rates[toCurrency]) {
                        throw new Error(`Exchange rate not found for ${toCurrency}`);
                    }
                    
                    const rate = rates[toCurrency];
                    
                    // Cache the result
                    this.ratesCache[cacheKey] = {
                        rate: rate,
                        timestamp: now
                    };
                    
                    return rate;
                    
                } catch (error) {
                    // If all APIs fail, try to use cached data even if expired
                    if (this.ratesCache[cacheKey]) {
                        console.warn('Using expired cache due to API failure');
                        return this.ratesCache[cacheKey].rate;
                    }
                    
                    throw error;
                }
            }
            
            // Show loading state
            showLoading(isLoading) {
                if (isLoading) {
                    this.loadingSpinner.style.display = 'inline-block';
                    this.buttonText.textContent = 'Converting...';
                    this.form.querySelector('button[type="submit"]').disabled = true;
                } else {
                    this.loadingSpinner.style.display = 'none';
                    this.buttonText.textContent = 'Convert';
                    this.form.querySelector('button[type="submit"]').disabled = false;
                }
            }
            
            // Display conversion result
            showResult(amount, fromCurrency, toCurrency, rate, convertedAmount = null) {
                if (convertedAmount === null) {
                    convertedAmount = amount * rate;
                }
                
                // Format numbers based on currency
                const fromFormatted = this.formatCurrency(amount, fromCurrency);
                const toFormatted = this.formatCurrency(convertedAmount, toCurrency);
                
                this.resultDiv.innerHTML = `
                    <div class="fw-bold text-success">
                        ${fromFormatted} = ${toFormatted}
                    </div>
                `;
                
                // Show exchange rate info
                this.rateText.textContent = `1 ${fromCurrency} = ${rate.toFixed(4)} ${toCurrency}`;
                this.rateInfo.style.display = 'block';
                
                // Show last updated time
                this.updateTime.textContent = `Last updated: ${new Date().toLocaleTimeString()}`;
                this.lastUpdated.style.display = 'block';
            }
            
            // Format currency with proper symbols and decimals
            formatCurrency(amount, currency) {
                try {
                    return new Intl.NumberFormat('en-US', {
                        style: 'currency',
                        currency: currency,
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    }).format(amount);
                } catch (error) {
                    // Fallback formatting if currency is not supported
                    return `${amount.toFixed(2)} ${currency}`;
                }
            }
            
            // Show error message
            showError(message) {
                this.resultDiv.innerHTML = `
                    <div class="text-danger">
                        <i class="bi bi-exclamation-triangle"></i> ${message}
                    </div>
                `;
                this.rateInfo.style.display = 'none';
                this.lastUpdated.style.display = 'none';
            }
            
            // Swap source and target currencies
            swapCurrencies() {
                const sourceValue = this.sourceCurrency.value;
                const targetValue = this.targetCurrency.value;
                
                if (sourceValue && targetValue) {
                    this.sourceCurrency.value = targetValue;
                    this.targetCurrency.value = sourceValue;
                    
                    // Trigger conversion if amount is present
                    if (this.amountInput.value) {
                        this.convertCurrency();
                    }
                }
            }
        }
        
        // Initialize the currency converter when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new CurrencyConverter();
        });
        
        // Service Worker for offline functionality (optional)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // You can implement service worker for offline caching
                console.log('Currency Converter loaded successfully!');
            });
        }
    </script>
</body>
</html>